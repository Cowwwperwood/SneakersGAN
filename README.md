# Генерация Кроссовок с использованием GAN

Этот проект посвящен генерации изображений кроссовок с помощью Генеративных Состязательных Сетей (GAN). Основной целью было разработать двухступенчатый процесс, который генерирует качественные изображения кроссовок, начиная с изображений низкого разрешения 28x28 и постепенно увеличивая их до разрешения 112x112.

## Структура проекта

Проект состоит из трех основных частей:

1. **Простой одноступенчатый GAN**:
   - На первом этапе был написан базовый одноступенчатый GAN, который генерировал изображения кроссовок, но результат был неудовлетворительным. Изображения получились абсолютно неразборчивы. Реализацию модели и трейнлупа можно увидеть в SimpleGAN.py и SimpleModelTrainloop.py.
2. **Двухступенчатый GAN**:
   - На втором этапе я улучшил архитектуру модели, разделив процесс генерации на две ступени:
     1. Первая ступень принимает изображение размером 28x28 и генерирует изображение того же размера (28x28) с изображением кроссовок. Реализацию модели и трейнлупа можно увидеть в DCGAN.py и DCGANTrainloop.py.
     2. Вторая ступень принимает изображения с первой ступени и увеличивает их разрешение до 112x112, улучшая качество и детализируя изображение. Реализацию модели и трейнлупа можно увидеть в SRGAN.py и SRGANTrainloop.py.

3. **Графики и примеры**:
   - Для каждого этапа обучения были собраны графики потерь (loss), показывающие прогресс модели, а также примеры изображений, сгенерированных на различных этапах обучения. Логирование и мониторинг был произведен через WandB.

## Шаги, предпринятые в проекте

### 1. Простой одноступенчатый GAN

На первом этапе я реализовал стандартную модель GAN с одной сетью генератора и одной сетью дискриминатора. Генератор принимает случайный шум в качестве входных данных и пытается генерировать изображения кроссовок, в то время как дискриминатор пытается отличить реальные изображения от фальшивых. На этой архитектуре не удалось получить хотя бы мало-мальски приемлимый результат, а лишь отдоленно напоминающий кроссовок силуэт.

### 2. Двухступенчатый GAN

На втором этапе я разделил процесс на два этапа:

1. **Первая ступень**: Генерация изображений 28x28
   - На этом этапе я использовал архитектуру GAN, которая обучается генерировать изображения размером 28x28. Входные данные для генератора — это случайный шум, а выходные данные — это изображения кроссовок в разрешении 28x28. Генератор и дискриминатор обучаются совместно, минимизируя потери для обоих.

2. **Вторая ступень**: Апскейлинг до 112x112
   - Вторая ступень берет изображения с разрешением 28x28, полученные с помощью первой модели, и увеличивает их разрешение до 112x112 с помощью второго генератора, который обучается улучшать детали и создавать более четкие изображения. Этот этап помогает устранить размытость и повысить качество изображения.

### 3. Примеры генерации и графики

Для наглядности, в проекте представлены следующие данные:

- **Примеры изображений**:
  - Примеры изображений, сгенерированных на каждом из этапов, показывают улучшение качества с каждой ступенью. Например, изображения, полученные после второй ступени, имеют четкие контуры и более детализированные элементы.

- **Графики обучения**:
  - В ходе обучения модели, для каждого из этапов собирались графики потерь (Loss) для дискриминатора и генератора. Эти графики показывают, как модель улучшалась на протяжении нескольких эпох. Потери постепенно уменьшались, что свидетельствует о более стабильном обучении.

Примеры изображений и графиков можно найти в следующем разделе.

## DataSet
  -Был использован DataSet из курса Computer Vision от МФТИ/ШАД, скачать который можно по ссылке: https://code.mipt.ru/courses-public/cv/storage/-/raw/tasks/sneaker-generation/data.zip .

## Пример обучения и генерации

1. **Простой GAN**:
   - Генерация изображений с разрешением 28x28. Несмотря на обучение, изображения получаются размытыми и слабо похожими на кроссовки.
   ![Simple GAN Example](https://github.com/Cowwwperwood/SneakersGAN/blob/main/Simple_Sneak.png)

2. **Двухступенчатый GAN**:
   - Первая ступень генерирует изображения с разрешением 28x28, которые затем увеличиваются во второй ступени до 112x112.
   - Пример сгенерированного изображения до апскейлинга:
   ![Upscaled Image Example](https://github.com/Cowwwperwood/SneakersGAN/blob/main/DC_Sneak.png)
   - Пример сгенерированного изображения после апскейлинга:
   ![Upscaled Image Example](https://github.com/Cowwwperwood/SneakersGAN/blob/main/SR_Sneak.png)

3. **Графики потерь**:
   - График потерь для DCGAN
   ![Upscaled Image Example](https://github.com/Cowwwperwood/SneakersGAN/blob/main/DC_Graphics.png)

   - Грифик потерь для SRGAN. Как можно заметить генератор с самых ранних эпох выдает постоянный loss : 0.693(~ln(2)) , что говорит о его неспособности корректно различать правдивые изображения и сгенерированные.
   ![Upscaled Image Example](https://github.com/Cowwwperwood/SneakersGAN/blob/main/SR_Graphics.png)



## Заключение

В ходе работы над проектом удалось реализовать двухступенчатую модель GAN, которая значительно улучшила качество генерации изображений кроссовок. Первая ступень генерирует базовые изображения, а вторая ступень апскейлит их до более высокого разрешения, улучшая детали. В дальнейшем проект можно расширить добавлением дополнительных улучшений, таких как использование более подходящей функции потерь для этой задачи, а также разрешение проблемы с обучением дискриминатора.

